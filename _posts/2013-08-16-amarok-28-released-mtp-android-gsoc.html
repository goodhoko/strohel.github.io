---
layout: post
title: 'Amarok 2.8 Released! (+MTP (Android) GSoC: weeks 8 & 9)'
date: '2013-08-16T23:00:00.000+02:00'
author: strohel
tags:
- amarok
- gsoc
- kde
modified_time: '2013-08-16T23:00:06.931+02:00'
thumbnail: http://1.bp.blogspot.com/-xXYpbG8wLiw/UgTzvFegnnI/AAAAAAAAAkM/rwspy6z-cbY/s72-c/GSoC2013-MTP-w8-editing.png
blogger_id: tag:blogger.com,1999:blog-4406477566892767740.post-3900929400721222698
blogger_orig_url: https://strohel.blogspot.com/2013/08/amarok-28-released-mtp-android-gsoc.html
---

<div style="text-align: justify;">Folks,<br />
the day has come.&nbsp;<a href="http://amarok.kde.org/en/releases/2.8">Amarok 2.8 is out!</a> I know I've already said it about 2.7, but this is the <i>best Amarok release</i>. <i>Ever</i>. The number of improvements and bugfixes is insane. The&nbsp;<a href="http://amarok.kde.org/en/releases/2.8">official release announcement</a> contains the most visible changes and the ChangeLog list them all, but let me highlight some that didn't fit into the announcement. We how (also) have:<br />

<ul><li><b>Opus codec</b> support including transcoding by Martin Brodbeck (only with development version of TagLib or 1.9 once it is released though).</li><li><b>ASX playlist</b> support by Tatjana Gornak (used by many on-line radios).</li><li>Improved <b>Nepomuk Collection</b> that dynamically queries Nepomuk by Edward Toroshchin (still in beta state though).</li><li>Fixed <b>Local Collection</b> and <b>Collection Browser</b> that reflects removed files and folders immediately.</li><li>More <b>keyboard shortcuts</b> and possible <b>UI workflows</b>.</li><li>Improved and fixed <b>Last.fm plugin</b>.</li><li>More control over <b>transcoding</b>.</li><li>Improved <b>File Browser</b>. </li></ul>We've changed a couple of existing things too:</div><div style="text-align: justify;"><ul><li>We've removed the splash screen, with an SSD is it just an unnecessary flicker.</li><li><i>Album Artist</i> level have replaced <i>Artist</i> one in the Collection Browser by default; the Artist level no-longer duplicates tracks under Various Artists.</li><li>Playback start on double-clicking has been made configurable, middle-click action to play tracks immediately has been added.</li></ul>Apart from releasing Amarok, I've also done some work on my GSoC project, although the amount of it has been limited by my other responsibilities. Here comes the report for my <a href="https://google-melange.appspot.com/gsoc/project/google/gsoc2013/strohel/32001">project to rewrite MTP (Android) support in Amarok from scratch</a>. I've mainly perfected editing of track metadata.<br />
<br />

<div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-xXYpbG8wLiw/UgTzvFegnnI/AAAAAAAAAkM/rwspy6z-cbY/s1600/GSoC2013-MTP-w8-editing.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="459" src="http://1.bp.blogspot.com/-xXYpbG8wLiw/UgTzvFegnnI/AAAAAAAAAkM/rwspy6z-cbY/s640/GSoC2013-MTP-w8-editing.png" width="640" /></a></div></div><div style="text-align: justify;"><br />
<b>What I've done last weeks:</b></div><ul><li style="text-align: justify;">Finished support for editing track metadata in a way that I'm satisfied with. It is a bit elaborate, but anything less would be suboptimal, see:</li><ol><li style="text-align: justify;">User changes some metadata.</li><ul><li style="text-align: justify;">we note the set of the metadata that she actually changed.</li></ul><li style="text-align: justify;">Background job to process the change is initiated.</li><li style="text-align: justify;">MTP commands to update the properties are sent to the device. If the user has disabled <i>Use File Metadata</i>, the job is finished. Else...</li><li style="text-align: justify;">If the track is not yet cached locally, it is downloaded to the local filesystem.</li><ul><li style="text-align: justify;">Because the file tags are usually more accurate than the metadata the MTP device provides us, we update the current metadata with file tags, <i>except</i> the ones that were changed.</li></ul><li style="text-align: justify;">Tags in the local cached file are updated using TagLib.</li><li style="text-align: justify;">The local cached file is (re)uploaded to the device under a temporary name with a random part in it.</li><li style="text-align: justify;">The old on-device track object is deleted</li><li style="text-align: justify;">The temporary on-device file is renamed back to the original one.</li></ol></ul><b>Problems I've faced:</b><br />
<ul><li style="text-align: justify;">There doesn't seem to be a way with MTP to replace contents of an existing object. This means that the item id of a existing tracks can change, which is unpleasant, but manageable.</li></ul><b>What's next:</b><br />
<ul><li style="text-align: justify;">Config dialog, and finally transferring tracks to the device! (it is in fact half-done, because the code will be shared with track editing support)</li></ul><div style="text-align: justify;">You can view and test my code by checking out <a href="http://quickgit.kde.org/?p=clones%2Famarok%2Flaitl%2Famarok.git&amp;a=shortlog&amp;h=gsoc">gsoc branch of my personal Amarok clone repository</a>.</div>
